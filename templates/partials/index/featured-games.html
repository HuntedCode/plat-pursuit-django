{% load humanize static %}

<section class="relative shadow-lg shadow-neutral w-full bg-base-200 rounded-box border-2 border-base-300 transition duration-300 hover:shadow-secondary hover:border-secondary">
    <div class="rounded-box p-4 bg-base-200 w-full transition duration-300 hover:bg-base-300">
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-center italic">Featured Games</h2>
        <div class="divider mt-2"></div>
        <div class="carousel carousel-start space-x-4 px-2 py-4 w-full snap-x snap-mandatory">
            {% for game in items %}
                <div class="carousel-item shadow-md shadow-neutral border-2 border-base-300 rounded-box w-full md:w-[calc(50%-0.5rem)] lg:w-[calc(33.333%-0.666rem)] shrink-0 group focus-within:outline-none focus-within:border-secondary snap-start hover:border-secondary hover:shadow-secondary hover:shadow-sm" tabindex="0">
                    <div class="relative overflow-hidden rounded-box shadow-xl w-full h-100 sm:h-140 md:h-100 lg:h-80 xl:h-120">
                        <div class="aspect-video bg-cover bg-center transition-transform duration-300 group-hover:scale-105 group-focus-within:scale-105 w-full h-full" style="background-image: url('{{ game.image }}');">
                            <!-- Info Card -->
                            <div class="absolute bottom-0 left-0 right-0 bg-base-100/90 bg-opacity-50 text-base-content shadow-lg border-t-2 border-base-200 px-4 py-2 transform translate-y-full transition-transform duration-300 hover:bg-base-300/90 ease-in-out group-hover:translate-y-0 group-focus-within:translate-y-0">
                                <h3 class="text-lg font-bold mb-2 text-center truncate">{{ game.name }}</h3>
                                <div class="flex flex-col items-center">
                                    <div class="flex flex-col mb-2">
                                        <div class="flex flex-row mb-2">
                                            <p class="text-xs">Trophies Earned: <span class="text-secondary font-bold">{{ game.trophiesEarned|intcomma }}</span></p>
                                            <div class="divider divider-horizontal mx-0"></div>
                                            <p class="text-xs">Platform: <span class="text-accent font-bold">{{ game.platform }}</span></p>
                                        </div>
                                        <div class="flex flex-col items-center gap-0 w-full">
                                            {% with completion=game.avgCompletion %}
                                                <progress class="progress {% if completion <= 33 %}progress-error{% elif completion <= 66 %}progress-warning{% else %}progress-success{% endif %} w-full" value="{{ completion }}" max="100" aria-label="Average completion: {{ completion|floatformat:2 }}%"></progress>
                                                <span class="text-xs xl:text-sm">Avg. Completion: {{ completion|floatformat:2 }}%</span>
                                            {% endwith %}
                                        </div>
                                    </div>
                                    <div class="flex flex-col gap-2 mb-2">
                                        <div class="flex flex-row">
                                            <div class="flex flex-row items-center gap-2">
                                                {% include 'partials/icons/trophy_cup.html' with color='var(--color-trophy-bronze)' size='w-8 h-8 mr-2' extra_class='hover:scale-105' %}
                                                <p class="text-base-content font-bold">{{ game.trophies.bronze }}</p>
                                            </div>
                                            <div class="divider divider-horizontal mx-2"></div>
                                            <div class="flex flex-row items-center gap-2">
                                                {% include 'partials/icons/trophy_cup.html' with color='var(--color-trophy-silver)' size='w-8 h-8 mr-2' extra_class='hover:scale-105' %}
                                                <p class="text-base-content font-bold">{{ game.trophies.silver }}</p>
                                            </div>
                                            <div class="divider divider-horizontal mx-2"></div>
                                            <div class="flex flex-row items-center gap-2">
                                                {% include 'partials/icons/trophy_cup.html' with color='var(--color-trophy-gold)' size='w-8 h-8 mr-2' extra_class='hover:scale-105' %}
                                                <p class="text-base-content font-bold">{{ game.trophies.gold }}</p>
                                            </div>
                                            <div class="divider divider-horizontal mx-2"></div>
                                            <div class="flex flex-row items-center gap-2">
                                                {% include 'partials/icons/trophy_cup.html' with color='var(--color-trophy-platinum)' size='w-8 h-8 mr-2' extra_class='hover:scale-105' %}
                                                <p class="text-base-content font-bold">{{ game.trophies.platinum }}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="{{ game.slug }}" class="btn btn-primary btn-sm w-full mb-4">Visit Game Page</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        <script src="{% static 'js/carousel.js' %}"></script>
    </div>
</section>