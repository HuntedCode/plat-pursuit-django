{% extends 'base.html' %}
{% load static %}

{% block title %}Reset Password{% endblock %}
{% block content %}
<div class="container mx-auto p-4 max-w-lg">
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">Reset Password</h2>

            {% if token_fail %}
                <div class="alert alert-error mb-4" role="alert">
                    Invalid or expired reset link. Please request a new one.
                </div>
                <a href="{% url 'account_reset_password' %}" class="btn btn-primary w-full">Request New Link</a>
            {% else %}
                <p class="mb-4">Enter your new password below.</p>

                {% if messages %}
                    <div aria-live="polite" aria-atomic="true">
                        {% for message in messages %}
                            <div class="alert {% if message.tags == 'error' %}alert-error{% else %}alert-info{% endif %} mb-4" role="{% if message.tags == 'error' %}alert{% else %}status{% endif %}">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

                <form method="post" class="space-y-4">
                    {% csrf_token %}
                    <input type="hidden" name="uidb36" value="{{ uid }}">
                    <input type="hidden" name="token" value="{{ token }}">
                    <div class="form-control">
                        <label class="label" for="id_password1">New Password</label>
                        <div class="input input-bordered w-full relative flex items-center pr-0">
                            <input type="password"
                                   name="password1"
                                   id="id_password1"
                                   class="flex-1 bg-transparent outline-none"
                                   placeholder="New Password"
                                   autocomplete="new-password"
                                   required>
                            <button type="button"
                                    class="flex items-center pr-3 text-gray-500 hover:text-gray-700"
                                    aria-label="Show password"
                                    aria-pressed="false"
                                    data-password-toggle="id_password1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="password-toggle-icon-1">
                                    <title id="password-toggle-icon-1">Show or hide password</title>
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <line x1="3" y1="3" x2="21" y2="21"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-control">
                        <label class="label" for="id_password2">Confirm New Password</label>
                        <div class="input input-bordered w-full relative flex items-center pr-0">
                            <input type="password"
                                   name="password2"
                                   id="id_password2"
                                   class="flex-1 bg-transparent outline-none"
                                   placeholder="Confirm New Password"
                                   autocomplete="new-password"
                                   required>
                            <button type="button"
                                    class="flex items-center pr-3 text-gray-500 hover:text-gray-700"
                                    aria-label="Show password"
                                    aria-pressed="false"
                                    data-password-toggle="id_password2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" role="img" aria-labelledby="password-toggle-icon-2">
                                    <title id="password-toggle-icon-2">Show or hide password</title>
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <line x1="3" y1="3" x2="21" y2="21"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary w-full">Reset Password</button>
                </form>
            {% endif %}

            <p class="mt-4 text-center"><a href="{% url 'account_login' %}" class="link link-primary">Back to Login</a></p>
        </div>
    </div>
</div>
{% endblock %}
{% block js_scripts %}
    <script src="{% static 'js/auth-forms.js' %}"></script>
    <script>
        PlatPursuit.ZoomScaler.init();
    </script>
{% endblock %}