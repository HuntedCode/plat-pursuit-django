{% extends 'base.html' %}
{% load static custom_filters %}
{% block title %}My Shareables{% endblock %}

{% block content %}
<section class="shadow-lg shadow-neutral bg-base-200/80 rounded-box border-2 border-base-300 w-full p-0 lg:p-4">
    {% include 'partials/breadcrumb.html' with items=breadcrumb %}

    <div class="card bg-base-100 border-4 border-base-300 shadow-md shadow-neutral">
        <div class="card-body">
            <h1 class="text-2xl lg:text-3xl font-bold">My Shareables</h1>
            <p class="text-base-content/70">Create and share images of your gaming achievements.</p>
        </div>
    </div>
</section>

{# Tabs for future extensibility #}
<section class="shadow-lg shadow-neutral bg-base-200/80 rounded-box border-2 border-base-300 w-full p-0 lg:p-4 mt-6">
    <div class="tabs tabs-boxed bg-base-100 p-2">
        <a href="?tab=platinum_images" class="tab tab-lg {% if active_tab == 'platinum_images' %}tab-active{% endif %}">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="var(--color-trophy-platinum)" viewBox="0 0 24 24">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
            </svg>
            Platinum Share Images
            {% if total_platinums %}
                <span class="badge badge-sm ml-2">{{ total_platinums }}</span>
            {% endif %}
        </a>
        {# Future tabs - disabled for now #}
        <a href="#" class="tab tab-lg opacity-50 cursor-not-allowed" title="Coming Soon" onclick="return false;">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
            </svg>
            Trophy Mosaic
            <span class="badge badge-ghost badge-sm ml-2">Soon</span>
        </a>
        <a href="#" class="tab tab-lg opacity-50 cursor-not-allowed" title="Coming Soon" onclick="return false;">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
            Trophy Calendar
            <span class="badge badge-ghost badge-sm ml-2">Soon</span>
        </a>
    </div>

    {# Tab Content #}
    <div class="mt-4 p-4">
        {% if active_tab == 'platinum_images' %}
            {% include 'shareables/partials/platinum_grid.html' %}
        {% endif %}
    </div>
</section>

{# Share Image Modal #}
<dialog id="share-modal" class="modal">
    <div class="modal-box max-w-4xl bg-base-200">
        <form method="dialog">
            <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </form>
        <h3 class="font-bold text-lg mb-4" id="share-modal-title">Create Share Image</h3>
        <div id="share-modal-content">
            {# ShareableManager will render content here #}
            <div class="flex justify-center items-center py-12">
                <span class="loading loading-spinner loading-lg"></span>
            </div>
        </div>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

{# Color Grid Modal - for background selection #}
{% include 'partials/color_grid_modal.html' with available_themes=available_themes %}
{% endblock %}

{% block js_scripts %}
<!-- Gradient themes from server (single source of truth) -->
<script>window.GRADIENT_THEMES = {% gradient_themes_json %};</script>
<script src="{% static 'js/share-image.js' %}"></script>
<script src="{% static 'js/color-grid-modal.js' %}"></script>
<script src="{% static 'js/shareable-manager.js' %}"></script>
{% endblock %}
