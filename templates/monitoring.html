{% extends 'base.html' %}
{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}
{% block title %}Token Monitoring{% endblock %}
{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold mb-6">TokenKeeper Monitoring Dashboard</h1>
    <div class="overflow-x-auto">
        <table class="table w-full">
            <thead>
                <tr>
                    <th scope="col">Machine</th>
                    <th scope="col">Instance</th>
                    <th scope="col">Busy</th>
                    <th scope="col">Healthy</th>
                    <th scope="col">Calls in Window</th>
                    <th scope="col">Access Token Expires In (s)</th>
                    <th scope="col">Refresh Token Expires In (s)</th>
                    <th scope="col">Token Scopes</th>
                    <th scope="col">NPSSO Cookie</th>
                </tr>
            </thead>
            <tbody id="stats-table">
                <!-- Populated by JS -->
            </tbody>
        </table>
    </div>
    <div class="mt-6">
        <canvas id="calls-chart" width="400" height="200" role="img" aria-label="Token keeper calls chart showing API call activity across instances"></canvas>
    </div>
</div>

{% load static %}
<script src="{% static 'js/monitoring.js' %}"></script>
{% endblock %}

{% block js_scripts %}
<script>PlatPursuit.ZoomScaler.init();</script>
{% endblock %}